<div
	#passwordTable
	class="password-table">
	<div
		id="table-header"
		(contextmenu)="$event.stopPropagation()">
		<div appSortBy="title">Title</div>
		<div appSortBy="username">Username</div>
		<div>Password</div>
	</div>
	<ng-container *ngIf="passwordList$ | async as passwordList">
		<cdk-virtual-scroll-viewport
			*ngIf="passwordList.length > 0; else noPasswordsTemplate"
			itemSize="32"
			class="table-viewport">
			<ng-container *cdkVirtualFor="let item of passwordList; trackBy: trackEntryById; templateCacheSize: 0">
				<div *ngIf="item.groupPath; else entryTemplate" class="entry-group">
					<div class="group-separator">
						<span class="pi pi-folder">
						</span> {{ item.groupPath }}
					</div>
				</div>
				<ng-template #entryTemplate>
					<div
						data-prevent-entry-deselect
						(click)="selectEntry($event, item)"
						(contextmenu)="selectEntry($event, item)"
						draggable="true"					
						(dragstart)="onDragStart($event, item)"
						(dragend)="onDragEnd()"
						[ngClass]="{'selected': isEntrySelected(item), 'is-dragging': isEntryDragged(item)}"
						class="row-entry">
						<div
							[appTextEmphasize]="searchPhrase$ | async"
							(dblclick)="copyToClipboard(item, 'title', item.title)"
							class="column long-text">{{ item.title }}
						</div>
						<div
							[appTextEmphasize]="searchPhrase$ | async"
							(dblclick)="copyToClipboard(item, 'username', item.username)"
							class="column long-text">{{ item.username }}
						</div>
						<div
							(dblclick)="copyToClipboard(item, 'password', item.password)"
							class="column">******
						</div>
					</div>
				</ng-template>
			</ng-container>
		</cdk-virtual-scroll-viewport>
		<ng-template #noPasswordsTemplate>
			<div class="list-cta">
				<ng-container *ngIf="(searchPhrase$ | async)?.length; else noEntriesTemplate">
					No results found
				</ng-container>
				<ng-template #noEntriesTemplate>
					<p>No entries have been added yet</p>
					<a href="#" class="outline-btn" (click)="addNewEntry(); false">Add entry</a>
				</ng-template>
			</div>
		</ng-template>
	</ng-container>
</div>

<p-contextMenu
	#entryContextMenu
	data-prevent-entry-deselect
	[model]="selectedEntries.length === 1 ? entryMenuItems : multiEntryMenuItems"
	[target]="passwordTable"
	(onShow)="onEntryContextMenuShow()"
	styleClass="entry-contextmenu">
</p-contextMenu>
