<div class="password-table">
	<div id="table-header" data-prevent-entry-deselect>
		<div class="group-data">
			{{ passwordEntries.length }}
		</div>
		<app-table-filters></app-table-filters>
	</div>
	<div *ngIf="searchPhrase?.length && (!isSearching || wasSearched)" class="results-badge" @slideIn>
		<div *ngIf="entriesFound$ | async as entriesCount">
			Found {{ entriesCount }} {{ entriesCount === 1 ? 'entry' : 'entries' }}:				
		</div>
	</div>
	<ng-container *ngIf="passwordList$ | async as passwordList">
		<cdk-virtual-scroll-viewport
			*ngIf="passwordList.length > 0; else noPasswordsTemplate"
			itemSize="56"
			role="rowgroup"
			appFocusableList
			(focused)="selectEntry($event.originalEvent, $event.item)"
			[selected]="selectedEntries"
			class="table-viewport">
			<ng-container *cdkVirtualFor="let item of passwordList; let i = index; trackBy: trackingTag; templateCacheSize: 0">
				<div
					data-prevent-entry-deselect
					[appFocusableListItem]="item"
					[appContextMenuItem]="getContextMenu(item)"
					(click)="selectEntry($event, item)"
					(contextmenu)="showEntryContextMenu($event, item)"
					[attr.draggable]="entriesDragEnabled"
					role="row"
					tabindex="0"
					(dragstart)="startDrag($event, item)"
					(dragend)="endDrag()"
					[ngClass]="{'selected': isEntrySelected(item), 'is-dragging': isEntryDragged(item)}"
					class="row-entry {{ item.expirationStatus ?? '' }}">
					<div *ngIf="iconsEnabled" class="column-icon">
						<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" [appEntryIcon]="item" width="28" height="28"/>
					</div>
					<div class="column long-text">
						<div class="row" [appTextEmphasize]="searchPhrase$ | async">
							{{ item.title }}
						</div>
						<div class="row" [appTextEmphasize]="searchPhrase$ | async" (dblclick)="copyToClipboard(item, 'username')" style="color: #999">
							{{ item.username }}
						</div>
					</div>
					<div
						(dblclick)="copyToClipboard(item, 'password')"
						class="column password">•••••• <i *ngIf="item.expirationStatus !== expirationStatus.None" class="pi pi-clock"></i>
					</div>
				</div>
			</ng-container>
		</cdk-virtual-scroll-viewport>
		<ng-template #noPasswordsTemplate>
			<div class="list-cta">
				<ng-container *ngIf="(searchPhrase$ | async)?.length || activeFilters?.length; else noEntriesTemplate">
					No matching entries found
				</ng-container>
				<ng-template #noEntriesTemplate>
					<p class="no-entries">There are no entries in this group</p>
					<button *ngIf="isAddPossible" class="outline-btn" id="add-entry-list" (click)="addNewEntry(); false">Add entry</button>
				</ng-template>
			</div>
		</ng-template>
	</ng-container>
</div>
